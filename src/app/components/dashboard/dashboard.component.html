<div class="dashboard-container">
  <!-- ============================= -->
  <!-- KPI CARDS -->
  <!-- ============================= -->

  <div class="kpi-grid">
    <mat-card class="kpi-card">
      <h3>Total Sales</h3>
      <h1>{{ kpis.totalSales | currency: "USD" }}</h1>
    </mat-card>

    <mat-card class="kpi-card">
      <h3>Total Customers</h3>
      <h1>{{ kpis.totalCustomers | number }}</h1>
    </mat-card>

    <mat-card class="kpi-card">
      <h3>Total Products</h3>
      <h1>{{ kpis.totalProducts | number }}</h1>
    </mat-card>
  </div>

  <!-- ============================= -->
  <!-- SALES BY VENDOR -->
  <!-- ============================= -->

  <mat-card class="chart-card">
    <h2>Sales By Vendor</h2>

    <!-- Filters -->
    <div class="filters">
      <label>Top:</label>
      <input
        style="
          width: 60px;
          text-align: center;
          background: rgba(255, 255, 255, 0.314);
          border: 1px solid rgba(255, 255, 255, 0.5);
          border-radius: 4px;
        "
        type="number"
        [(ngModel)]="topVendor"
        (change)="onVendorFilterChange()"
        min="1"
      />

      <label>Category:</label>
      <select
        style="
          width: 100px;
          text-align: center;
          background: rgba(255, 255, 255, 0.314);
          border: 1px solid rgba(255, 255, 255, 0.5);
          border-radius: 4px;
        "
        [(ngModel)]="categoryVendor"
        (change)="onVendorFilterChange()"
      >
        <option *ngFor="let c of categories" [value]="c">
          {{ c }}
        </option>
      </select>

      <label>Sort:</label>
      <select
        style="
          width: 80px;
          text-align: center;
          background: rgba(255, 255, 255, 0.314);
          border: 1px solid rgba(255, 255, 255, 0.5);
          border-radius: 4px;
        "
        [(ngModel)]="sortVendor"
        (change)="onVendorFilterChange()"
      >
        <option value="desc">Desc</option>
        <option value="asc">Asc</option>
      </select>
    </div>

    <!-- ================= LOADING BAR ================= -->

    <div
      *ngIf="chartLoading"
      style="margin-bottom: 15px; text-align: center; color: white"
    >
      Loading Charts... {{ chartProgress }}%
      <mat-progress-bar mode="determinate" [value]="chartProgress">
      </mat-progress-bar>
    </div>

    <!-- Chart -->
    <div *ngIf="!chartLoading">
      <canvas
        baseChart
        [data]="vendorChartData"
        [options]="vendorChartOptions"
        [type]="'bar'"
      >
      </canvas>
    </div>
  </mat-card>

  <!-- ============================= -->
  <!-- LAST TWO CHARTS SIDE BY SIDE -->
  <!-- ============================= -->

  <div class="charts-row">
    <!-- =============================== -->
    <!-- PRODUCTS BY PROFIT -->
    <!-- =============================== -->

    <mat-card class="chart-card half">
      <h2>Products By Profit</h2>

      <div class="filters">
        <label>Top:</label>
        <input
          style="
            width: 60px;
            text-align: center;
            background: rgba(255, 255, 255, 0.314);
            border: 1px solid rgba(255, 255, 255, 0.5);
            border-radius: 4px;
          "
          type="number"
          [(ngModel)]="topProfit"
          (change)="loadProductsByProfit()"
          min="1"
        />

        <label>Sort:</label>
        <select
          style="
            width: 80px;
            text-align: center;
            background: rgba(255, 255, 255, 0.314);
            border: 1px solid rgba(255, 255, 255, 0.5);
            border-radius: 4px;
          "
          [(ngModel)]="sortProfit"
          (change)="loadProductsByProfit()"
        >
          <option value="desc">Desc</option>
          <option value="asc">Asc</option>
        </select>
      </div>

      <!-- LOADING -->
      <div
        *ngIf="chartLoading"
        style="margin-bottom: 15px; text-align: center; color: white"
      >
        Loading Charts... {{ chartProgress }}%
        <mat-progress-bar mode="determinate" [value]="chartProgress">
        </mat-progress-bar>
      </div>

      <div style="height: 350px" *ngIf="!chartLoading">
        <canvas
          baseChart
          [data]="profitChartData"
          [options]="profitChartOptions"
          [type]="'bar'"
        >
        </canvas>
      </div>
    </mat-card>

    <!-- =============================== -->
    <!-- SALES VS PURCHASE (LINE) -->
    <!-- =============================== -->

    <mat-card class="chart-card half">
      <h2>Sales vs Purchase Trend</h2>

      <!-- LOADING -->
      <div
        *ngIf="chartLoading"
        style="margin-bottom: 15px; text-align: center; color: white"
      >
        Loading Charts... {{ chartProgress }}%
        <mat-progress-bar mode="determinate" [value]="chartProgress">
        </mat-progress-bar>
      </div>

      <div style="height: 350px" *ngIf="!chartLoading">
        <canvas
          baseChart
          [data]="comparisonChartData"
          [options]="comparisonChartOptions"
          [type]="'line'"
        >
        </canvas>
      </div>
    </mat-card>
  </div>
</div>
